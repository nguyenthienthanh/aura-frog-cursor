---
description: Follow established codebase patterns from session context. Read .cursor/aura-frog/session-context.toon before analysis, tech specs, or code generation.
globs: []
alwaysApply: true
---

# Codebase Consistency Rule

**Version:** 1.1.7
**Priority:** HIGH - Apply before any code generation

---

## Purpose

Ensures all generated code follows established project patterns by reading the session context file.

---

## Session Context Location

```
.cursor/aura-frog/session-context.toon
```

This file is generated by `project-context-loader` skill and contains:
- Current workflow state
- Architectural decisions made this session
- Established naming/coding patterns
- Import conventions

---

## Before Any Work

**ALWAYS read `.cursor/aura-frog/session-context.toon` before:**
- Analyzing requirements or codebase
- Writing technical specifications
- Creating design documents
- Creating new files
- Writing functions/components
- Adding imports
- Refactoring code

---

## Context File Format

```toon
state{phase,feature,started}:
 implementation,User Authentication,2025-12-16T10:00

decisions[N]{id,choice,reason}:
 1,JWT tokens,Stateless + scalable
 2,bcrypt,Industry standard

patterns[N]{type,convention,example}:
 naming,camelCase functions,getUserById
 naming,PascalCase components,UserProfile
 imports,absolute paths,@/components/Button
 structure,feature folders,src/features/auth/
```

---

## Pattern Application

### Naming Conventions
Follow patterns from `patterns[]{type=naming}`:
```typescript
// If pattern: "camelCase functions, getUserById"
function getUserById() {}  // ✅ Correct
function GetUserById() {}  // ❌ Wrong
```

### Import Style
Follow patterns from `patterns[]{type=imports}`:
```typescript
// If pattern: "absolute paths, @/components/Button"
import { Button } from '@/components/Button';  // ✅ Correct
import { Button } from '../../../Button';      // ❌ Wrong
```

### File Structure
Follow patterns from `patterns[]{type=structure}`:
```
// If pattern: "feature folders, src/features/auth/"
src/features/auth/
├── components/
├── hooks/
├── utils/
└── index.ts
```

---

## Session State Awareness

Read `state{}` to understand current context:
- **phase** - Current workflow phase (design, implementation, testing)
- **feature** - Feature being worked on
- **started** - When session started

---

## Decision Consistency

Honor decisions from `decisions[]`:
```toon
decisions[2]{id,choice,reason}:
 1,JWT tokens,Stateless + scalable
 2,Redis sessions,Fast lookup
```

Do NOT suggest alternatives to decisions already made this session.

---

## If Context Missing

If `.cursor/aura-frog/session-context.toon` doesn't exist:
1. Check `.cursor/project-contexts/` for project config
2. Use `project-context-loader` skill to generate it
3. Fall back to codebase scanning for patterns

---

## Quick Reference

```toon
actions[6]{when,action}:
 Analysis,Read session-context.toon first
 Tech spec,Read session-context.toon + check decisions[]
 New file,Read session-context.toon first
 New function,Match naming pattern from context
 New import,Match import style from context
 Architecture decision,Check decisions[] for prior choices
```

---

**Version:** 1.1.7
**Last Updated:** 2025-12-17
