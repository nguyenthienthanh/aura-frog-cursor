---
description: 9-phase workflow orchestration, navigation, deliverables, and phase management
globs: []
alwaysApply: false
---

# Workflow System

**Version:** 1.12.0
**Type:** Rule (Mandatory)

Activated when using workflow-orchestrator skill or workflow commands.

---

## 9-Phase Structure

| Group | Phase | Name | Agent | Skippable |
|-------|-------|------|-------|-----------|
| Planning | 1 | Understand | pm-operations-orchestrator | No |
| Planning | 2 | Design | Development agent | No |
| Planning | 3 | UI Breakdown | ui-designer | Yes (no UI) |
| Planning | 4 | Plan Tests | qa-automation | No |
| Building | 5a | TDD RED | Dev agent | No |
| Building | 5b | TDD GREEN | Dev agent | No |
| Building | 5c | TDD REFACTOR | Dev agent | No |
| Quality | 6 | Review | code-reviewer | No |
| Quality | 7 | Verify | qa-automation | No |
| Shipping | 8 | Document | Dev agent | No |
| Shipping | 9 | Share | Auto-executes | N/A |

---

## Approval Gates

**Only 2 mandatory gates:** Phase 2 (Design) and Phase 5b (Implementation).
All other phases auto-continue unless a blocker is hit.

| Response | Action |
|----------|--------|
| `approve` / `yes` | Proceed to next phase, AUTO-CONTINUE |
| `reject: <reason>` | Restart phase with feedback |
| `modify: <changes>` | Adjust deliverables without restart |
| `stop` / `cancel` | Cancel workflow |

After approval, IMMEDIATELY execute next phase (no waiting for next prompt).

---

## Phase Deliverables

| Phase | Key Document | Must Have |
|-------|-------------|-----------|
| 1 | REQUIREMENTS.md | User stories, acceptance criteria, scope |
| 2 | TECH_SPEC.md + TECH_SPEC_CONFLUENCE.md | Architecture, files, APIs (AI reads TECH_SPEC.md) |
| 3 | UI_BREAKDOWN.md | Components, props, accessibility |
| 4 | TEST_PLAN.md | Test scenarios, coverage target (>=80%) |
| 5a | Test files (src/**/__tests__/) | All tests FAIL |
| 5b | Implementation code | All tests PASS, lint clean |
| 5c | Refactored code | Tests still pass, coverage maintained |
| 6 | CODE_REVIEW.md | Security, performance, best practices |
| 7 | QA_REPORT.md | Test results, coverage, acceptance validation |
| 8 | IMPLEMENTATION_SUMMARY.md | Changes, deployment guide, CHANGELOG update |
| 9 | Workflow archive | JIRA/Slack updates, all docs archived |

All deliverables saved to: `.cursor/logs/workflows/{workflow-id}/`

---

## Navigation & Progress

After each phase, show:

```
WORKFLOW PROGRESS
Progress: ████████░░░░░░░░ 50% (4/8 phases)
[done] Phase 1-2  [current] Phase 3  [pending] Phase 4-9  [skip] Phase 3 (if no UI)
Next: Phase N - Description
```

---

## Blocking Conditions

- **5a RED**: Any test passes, or failures are logic errors (not "not found")
- **5b GREEN**: Any test fails, coverage < 80%, linter errors
- **5c REFACTOR**: Tests fail, coverage drops, new linter errors
- **6 Review**: Linter errors, critical security issues
- **7 Verify**: Failing tests, unvalidated acceptance criteria

---

## Session Handoff

| Threshold | Action |
|-----------|--------|
| 150K (75%) | Warning - plan handoff |
| 175K (87.5%) | Critical - run `workflow:handoff` |
| 200K (100%) | Hard limit |

Resume: `workflow:resume [workflow-id]`

---

## Quality Principles

- **KISS**: Simplest solution that works; solve today's problem
- **DRY (Rule of Three)**: 1st: write it, 2nd: duplicate, 3rd: refactor
- **TDD**: RED (fail) -> GREEN (pass) -> REFACTOR (clean)
- **Cross-Review**: Multi-agent validation at phases 1, 2, 4, 6

---

## References

- Phase guides: `.cursor/workflows/phases/phase-*.md`
- State management: `.cursor/workflows/STATE_MANAGEMENT.md`
- Quick reference: `.cursor/workflows/QUICK_REFERENCE.md`
- Skills: `workflow-orchestrator`, `phase-skipping`, `jira-integration`, `figma-integration`
- Related rules: `deliverable-persistence.mdc`, `kiss-principle.mdc`, `cross-review.mdc`

---

**Version:** 1.12.0
**Last Updated:** 2026-02-14
