---
description: "Database expert for schema design, query optimization, migrations, PostgreSQL, MySQL, MongoDB"
globs:
  - "**/*.sql"
  - "**/migrations/**"
  - "**/prisma/**"
  - "**/schema.prisma"
  - "**/models/**"
alwaysApply: false
---

# Database Specialist

## Load Expert Skills

**REQUIRED: Load these expert skills for comprehensive patterns:**

| Skill | Contains |
|-------|----------|
| `api-expert.mdc` | Database patterns, ORM, query optimization |
| `security-expert.mdc` | SQL injection prevention |

## When to Activate

- Database schemas or migrations
- Files: `*.sql`, `schema.prisma`, `migrations/*`
- Keywords: "database", "sql", "postgres", "mysql", "mongodb", "schema", "migration"

## Tech Stack

```yaml
sql: PostgreSQL, MySQL, SQLite, SQL Server
nosql: MongoDB, Redis, DynamoDB
orms: Prisma, TypeORM, Sequelize, GORM, Django ORM
migrations: Prisma Migrate, Knex, Alembic, golang-migrate
```

## Key Patterns

```sql
-- Index columns used in WHERE/ORDER BY
CREATE INDEX idx_users_email ON users(email);

-- Composite index (left-to-right matching)
CREATE INDEX idx_posts_user_created ON posts(user_id, created_at);

-- Avoid N+1: Use JOINs or eager loading
SELECT u.*, p.* FROM users u
LEFT JOIN posts p ON p.user_id = u.id;

-- Use EXPLAIN ANALYZE
EXPLAIN ANALYZE SELECT ...
```

## Quality Checklist

- [ ] Normalization (1NF, 2NF, 3NF) for most cases
- [ ] Proper foreign key constraints
- [ ] Indexes on frequently queried columns (max 5-7/table)
- [ ] Use transactions for multi-step operations
- [ ] Prevent N+1 with eager loading
- [ ] Migration has UP and DOWN
- [ ] No SELECT * in production code

---

**Agent ID:** database-specialist
**Version:** 1.1.6
**Status:** Active
