---
description: "CRITICAL: Runs FIRST for EVERY message. Selects optimal agent based on technology mentions, intent, project context, and file patterns."
globs: []
alwaysApply: true
---

# Agent Detector

**Trigger:** Every message. Runs FIRST before any other skill.

## Detection Layers (Score & Select)

### Layer 1: Explicit Technology (+60 pts)

| Keywords | Agent |
|----------|-------|
| react-native, expo, RN | mobile-react-native |
| flutter, dart, bloc | mobile-flutter |
| angular, ngrx, rxjs | web-angular |
| vue, vuejs, pinia, nuxt | web-vuejs |
| react, reactjs, jsx | web-reactjs |
| next, nextjs, ssr, ssg | web-nextjs |
| nodejs, express, nestjs | backend-nodejs |
| python, django, fastapi | backend-python |
| go, golang, gin, fiber | backend-go |
| laravel, php, eloquent | backend-laravel |

### Layer 2: Intent Detection

| Intent | Keywords | Primary | Secondary |
|--------|----------|---------|-----------|
| Implementation | implement, create, build | Dev agent | qa-automation |
| Bug Fix | fix, bug, error, crash | Dev agent | qa-automation |
| Testing | test, coverage, QA | qa-automation | Dev agent |
| Design/UI | design, UI, figma, style | ui-designer | Dev agent |
| Database | schema, query, migration | database-specialist | Backend |
| Security | security, vulnerability | security-expert | Dev agent |
| DevOps | deploy, docker, CI/CD | devops-cicd | - |

### Layer 3: Project Context (+40 pts)

Check: `project-config.yaml`, `package.json`, `composer.json`, `pubspec.yaml`, `go.mod`, CWD path.

### Layer 4: File Patterns (+20 pts)

`*.phone.tsx` → RN, `*.dart` → Flutter, `*.component.ts` → Angular, `*.vue` → Vue, `app/*/route.ts` → Next.js, `*.go` → Go, `*Controller.php` → Laravel.

## Agent Thresholds

| Score | Role |
|-------|------|
| ≥80 | Primary (leads task) |
| 50-79 | Secondary (supporting) |
| 30-49 | Optional |
| <30 | Not selected |

## qa-automation Rules

- **Always secondary** for: implementation, bug fixes
- **Primary** for: test/coverage/QA requests
- **Skipped** for: docs-only, design discussion, research

## After Detection

1. Load agent instructions from `.cursor/rules/agents/`
2. Route to skill: complex → `workflow-orchestrator`, bug → `bugfix-quick`, test → `test-writer`, review → `code-reviewer`
3. Load project context via `project-context-loader`

Manual override: User says "Use only [agent]" → that agent becomes PRIMARY.

---

**Version:** 1.12.0
