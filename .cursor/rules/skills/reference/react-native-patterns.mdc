---
description: "React Native patterns for hooks, components, state management, performance"
globs:
  - "**/*.tsx"
  - "**/*.ts"
  - "**/app.json"
alwaysApply: false
---

# React Native Patterns

## Custom Hook Pattern

```typescript
export function useSocialMediaShare() {
  const [status, setStatus] = useState<'idle' | 'loading' | 'success' | 'error'>('idle');
  const [error, setError] = useState<Error | null>(null);

  const share = useCallback(async (platform: Platform, content: ShareContent) => {
    setStatus('loading');
    try {
      const result = await shareApi.post(platform, content);
      setStatus('success');
      return result;
    } catch (err) {
      setError(err as Error);
      setStatus('error');
    }
  }, []);

  return { status, error, share };
}
```

## Container/Presentational Pattern

```typescript
// Presentational (UI only)
export const ShareButton: FC<ShareButtonProps> = ({ onPress, loading }) => (
  <TouchableOpacity onPress={onPress} disabled={loading}>
    {loading ? <Spinner /> : <Text>Share</Text>}
  </TouchableOpacity>
);

// Container (logic)
export const ShareButtonContainer: FC = () => {
  const { share, status } = useSocialMediaShare();
  return (
    <ShareButton
      onPress={() => share('facebook', content)}
      loading={status === 'loading'}
    />
  );
};
```

## Zustand Slice Pattern

```typescript
export const createShareSlice: StateCreator<ShareSlice> = (set) => ({
  recentShares: [],
  addShare: (share) => set((state) => ({
    recentShares: [share, ...state.recentShares].slice(0, 10)
  })),
});

export const useBoundStore = create<ShareSlice>()(
  persist(immer(createShareSlice), { name: 'app-storage' })
);
```

## Performance Patterns

```typescript
// Memoization
const sortedItems = useMemo(() => items.sort(...), [items]);
const handlePress = useCallback((id) => navigate(id), []);
const UserCard = React.memo<Props>(({ user }) => <View>...</View>);

// FlatList optimization
<FlatList
  data={items}
  keyExtractor={(item) => item.id}
  removeClippedSubviews={true}
  maxToRenderPerBatch={10}
  windowSize={10}
/>
```

## Type-Safe Navigation

```typescript
type RootStackParamList = {
  Home: undefined;
  Profile: { userId: string };
};

type Props = NativeStackScreenProps<RootStackParamList, 'Profile'>;

export const ProfileScreen: FC<Props> = ({ route }) => {
  const { userId } = route.params;
  return <View>...</View>;
};
```

## Best Practices

```typescript
// ✅ DO
// - Use TypeScript strict mode
// - Memoize expensive computations
// - Extract reusable hooks
// - Use theme for styling

// ❌ DON'T
// - Use inline functions in render
// - Mutate state directly
// - Use any type
// - Put business logic in components
```

---

**Used by:** mobile-react-native agent
